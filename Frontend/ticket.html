<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Your Ticket</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>

<body class="bg-gray-900 min-h-screen flex flex-col items-center justify-center">

<div id="ticket" class="bg-white rounded-2xl shadow-2xl w-[700px] p-6">

  <div class="flex justify-between items-center border-b pb-4">
    <h1 class="text-2xl font-bold">ðŸŽ¢ Amusement Park</h1>
    <p class="text-sm text-gray-500">E-Ticket</p>
  </div>

  <div class="grid grid-cols-2 gap-4 mt-4">
    <div>
      <p><b>Name:</b> <span id="tName"></span></p>
      <p><b>Email:</b> <span id="tEmail"></span></p>
      <p><b>Booking Date:</b> <span id="tDate"></span></p>
      <p><b>Type:</b> <span id="tType"></span></p>
      <p><b>People:</b> <span id="tPeople"></span></p>
      <p><b>Parking:</b> <span id="tParking"></span></p>
      <p><b>Food:</b> <span id="tFood"></span></p>
      <p><b>Valid From:</b> <span id="tFrom"></span></p>
      <p><b>Valid Till:</b> <span id="tTill"></span></p>
    </div>

    <div class="flex flex-col items-center justify-center">
      <canvas id="qr"></canvas>
      <p class="text-sm text-gray-500 mt-2">Scan at Entry</p>
    </div>
  </div>

  <div class="mt-4 border-t pt-4 flex justify-between items-center">
    <p class="text-xl font-bold">Total: â‚¹ <span id="tTotal"></span></p>
    <p class="text-sm text-gray-500">Booking ID: <span id="tId"></span></p>
  </div>

</div>

<div class="mt-6 text-center">
  <button onclick="downloadPDF()"
    class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-xl">
    Download PDF
  </button>
</div>

<script>
// Get booking data
const data = JSON.parse(localStorage.getItem("bookingData"));

if(!data || !data.name) {
  alert("Session expired. Please book again.");
  window.location.href = "booking.html";
}

// Fill UI
document.getElementById("tName").innerText = data.name;
document.getElementById("tEmail").innerText = data.email;
document.getElementById("tDate").innerText = data.bookingDate;
document.getElementById("tType").innerText = data.type;
document.getElementById("tPeople").innerText = data.people;
document.getElementById("tParking").innerText = data.parking ? "Yes" : "No";
document.getElementById("tFood").innerText = data.food ? "Yes" : "No";
document.getElementById("tTotal").innerText = data.total;
document.getElementById("tFrom").innerText = data.validFrom;
document.getElementById("tTill").innerText = data.validTill;

// Unique Booking ID
const bookingId = "AP" + Math.floor(Math.random() * 1000000);
document.getElementById("tId").innerText = bookingId;

// QR Code Data
const qrData = JSON.stringify({...data, bookingId});
QRCode.toCanvas(document.getElementById("qr"), qrData);

// Download PDF
function downloadPDF() {
  window.print();
}
</script>

<style>
@media print {
  body * {
    visibility: hidden;
  }
  #ticket, #ticket * {
    visibility: visible;
  }
  #ticket {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
  }
}
</style>

</body>
</html>
